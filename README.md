# ECE419 Distributed Systems Project
This project was done for my ECE419 Distributed Systems course at University of Toronto. The task was to develop a  distributed key-value storage service with persistant storage (and caching) and the accessing client. 

## How It Works
Data records (i.e., key-value pairs, a.k.a., tuples) are distributed over a number of storage servers by exploiting the capabilities of consistent hashing. A single storage server is only responsible for a subset of the whole key space (i.e., a range of successive hash values.) A hash function is used to determine the location of particular tuples (i.e., hash values of the associated keys).

The client can connect to one of these storage servers and modify/access the data through commands sent over web sockets to the servers. The client library enables access to the storage service by providing the KV-Storage interface (connect, disconnect, get, put). Furthermore, the library keeps the distribution of data transparent to the client application (e.g., the command line shell.)  In order to forward requests to the storage server that is responsible for a particular tuple, the client library maintains metadata about the current state of the storage service. Metadata at the client side may be stale due to reorganizations within the storage service. Therefore, the library has to process requests optimistically. If a client request is forwarded to the wrong storage server, the storage server will answer with an appropriate error and the most recent version of the metadata. After updating its metadata, the client will retry the request (possibly contacting another storage server.)

Each storage server (KVServer) is responsible for a subset of the data according to its position in the hash ring. The position implicitly defines a subrange within the complete hash range. If the server receives a request for a key with a hash value not within the server's range, it replies to the request with the updated metadata that contains the range distributions for every server.

The storage servers are monitored and controlled by an External Configuration Service (ECS). By means of the configuration service, an administrator is able to initialize and control the storage service (i.e., add/remove storage servers and invoke reconciliation of metadata at affected storage servers).

## Things To Do Before Running the Project
Run `ant` in the project directory to build the client, server, and ecs jar files

### How to Run The Server
1. In ./src/app_kvEcs/script.sh, modify the path to go to the jar file for server : ms3-server.jar
2. In ./src/app_kvEcs/ecs.conf, you can modify the number of servers and the IP addresses or ports of these servers as you like
2. Run the following command to ensure SSH does not bother anyone: ssh-keygen -R 127.0.0.1
3. Run ms3-ecs.jar 
4. Enjoy!

### How to Run The Client
1. Run ms3-client.jar
2. Connect to a server generated by the ECS client
3. Use the help command to see all the commands possible
4. Enjoy!

### Things To Know
- The data folder at the base directory (the directory that comes up when you write the command cd)
	contains the data files for the servers instantiated by the ECS (they are generated in the root directory)
- The log folder in the same place also has the logs for the servers
- The data folder in the project directory contains data that is persisted
	to the ECS once all servers are shutdown
- Likewise for the log folder, it contains the log for the ECS
